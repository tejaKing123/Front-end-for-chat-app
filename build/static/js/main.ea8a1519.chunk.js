(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{122:function(e,t,s){},123:function(e,t,s){},124:function(e,t,s){},127:function(e,t,s){"use strict";s.r(t);var c,n,a=s(0),r=s(1),i=s.n(r),o=s(60),l=s.n(o),j=(s(68),s(7)),u=s.n(j),d=s(12),b=s(2),m=(s(70),s(11)),O=s(3),h=Object(r.createContext)(null),x=s(24),f=s(23),p=s.n(f),v=(s(99),function(e){var t=e.message,s=t.name,c=t.user_id,n=t.text,r=!1;return c===e.current_uid&&(r=!0),r?Object(a.jsx)("div",{className:"row right-align",children:Object(a.jsx)("div",{className:"col s12 m8 16 right",children:Object(a.jsxs)("p",{className:"sentbyme",children:[" ",s,": ",n]})})}):Object(a.jsx)("div",{className:"row left-align",children:Object(a.jsx)("div",{className:"col s12 m8 16 left",children:Object(a.jsxs)("p",{className:"opponent",children:[" ",s,": ",n]})})})}),g=s(61),N=s.n(g),w=(s(122),function(e){var t=e.messages,s=e.user_id;return Object(a.jsx)(N.a,{className:"messages",children:t.map((function(e,t){return Object(a.jsx)(v,{message:e,current_uid:s},e._id)}))})}),S=(s(123),function(e){var t=e.message,s=e.setMessage,c=e.sendMessage;return Object(a.jsxs)("form",{action:"",onSubmit:c,className:"form",children:[Object(a.jsx)("input",{type:"text",className:"input",placeholder:"Type a message",value:t,onChange:function(e){return s(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?c(e):null}}),Object(a.jsx)("button",{className:"sendButton",children:"Send Message"})]})}),y=(s(124),function(){var e=Object(r.useContext)(h),t=e.user,s=(e.setUser,Object(O.g)()),n=s.room_id,i=(s.room_name,Object(r.useState)("")),o=Object(b.a)(i,2),l=o[0],j=o[1],u=Object(r.useState)([]),d=Object(b.a)(u,2),m=d[0],f=d[1];Object(r.useEffect)((function(){(c=p()("localhost:5000")).emit("join",{name:t.name,room_id:n,user_id:t._id})}),[]),Object(r.useEffect)((function(){c.on("message",(function(e){f([].concat(Object(x.a)(m),[e]))}))}),[m]),Object(r.useEffect)((function(){c.emit("get-messages-history",n),c.on("output-messages",(function(e){f(e)}))}),[]);return Object(a.jsx)("div",{className:"outerContainer",children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(w,{messages:m,user_id:t._id}),Object(a.jsx)(S,{message:l,setMessage:j,sendMessage:function(e){e.preventDefault(),l&&(console.log(l),c.emit("sendMessage",l,n,(function(){return j("")})))}})]})})}),C=function(e){var t=e.name;return Object(a.jsx)("div",{className:"card horizontal",children:Object(a.jsx)("div",{className:"card-stacked",children:Object(a.jsx)("div",{className:"card-content",children:Object(a.jsx)("p",{children:t})})})})},_=function(e){var t=e.rooms;return Object(a.jsx)("div",{children:t&&t.map((function(e){return Object(a.jsx)(m.b,{to:"/chat/"+e._id+"/"+e.name,children:Object(a.jsx)(C,{name:e.name})},e._id)}))})},k=function(){var e=Object(r.useContext)(h),t=e.user,s=(e.setUser,Object(r.useState)("")),c=Object(b.a)(s,2),i=c[0],o=c[1],l=Object(r.useState)([]),j=Object(b.a)(l,2),u=j[0],d=j[1],m="localhost:5000";Object(r.useEffect)((function(){return n=p()(m),function(){n.emit("disconnect"),n.off()}}),[m]),Object(r.useEffect)((function(){n.on("output-rooms",(function(e){d(e)}))}),[]),Object(r.useEffect)((function(){n.on("room-created",(function(e){d([].concat(Object(x.a)(u),[e]))}))}),[u]),Object(r.useEffect)((function(){console.log(u)}),[u]);return t?Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("div",{className:"col s12 m6",children:Object(a.jsxs)("div",{className:"card blue-grey darken-1",children:[Object(a.jsxs)("div",{className:"card-content white-text",children:[Object(a.jsxs)("span",{className:"card-title",children:["Welcome ",t?t.name:""]}),Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n.emit("create-room",i),console.log(i),o("")},children:[Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"input-field col s12",children:[Object(a.jsx)("input",{placeholder:"Enter a room name",id:"room",type:"text",className:"validate",value:i,onChange:function(e){return o(e.target.value)}}),Object(a.jsx)("label",{htmlFor:"room",children:"Room"})]})}),Object(a.jsx)("button",{className:"btn",children:"Create Room"})]})]}),Object(a.jsx)("div",{className:"card-action"})]})}),Object(a.jsx)("div",{className:"col s6 m5 offset-1",children:Object(a.jsx)(_,{rooms:u})})]})}):Object(a.jsx)(O.a,{to:"/login"})},E=function(e){var t=e.logout;return Object(a.jsx)("li",{onClick:t,children:Object(a.jsx)("a",{href:"#",children:"Logout"})})},F=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("li",{children:Object(a.jsx)("a",{href:"/login",children:"Login"})}),Object(a.jsx)("li",{children:Object(a.jsx)("a",{href:"/signup",children:"Signup"})})]})},P=function(){var e=Object(r.useContext)(h),t=e.user,s=e.setUser,c=function(){var e=Object(d.a)(u.a.mark((function e(){var t,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5000/logout",{credentials:"include"});case 3:t=e.sent,c=t.json(),console.log("logout data",c),s(null),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=t?Object(a.jsx)(E,{logout:c}):Object(a.jsx)(F,{});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("nav",{className:"green",children:Object(a.jsxs)("div",{className:"nav-wrapper",children:[Object(a.jsx)("a",{href:"/",className:"brand-logo",children:"Chat"}),Object(a.jsx)("a",{href:"#","data-target":"mobile-demo",className:"sidenav-trigger",children:Object(a.jsx)("i",{className:"material-icons",children:"menu"})}),Object(a.jsx)("ul",{id:"nav-mobile",className:"right hide-on-med-and-down",children:n})]})}),Object(a.jsx)("ul",{className:"sidenav",id:"mobile-demo",children:n})]})},T=function(){var e=Object(r.useContext)(h),t=e.user,s=e.setUser,c=Object(r.useState)(""),n=Object(b.a)(c,2),i=n[0],o=(n[1],Object(r.useState)("")),l=Object(b.a)(o,2),j=l[0],m=l[1],x=Object(r.useState)(""),f=Object(b.a)(x,2),p=f[0],v=f[1],g=Object(r.useState)(""),N=Object(b.a)(g,2),w=(N[0],N[1]),S=Object(r.useState)(""),y=Object(b.a)(S,2),C=y[0],_=y[1],k=Object(r.useState)(""),E=Object(b.a)(k,2),F=E[0],P=E[1],T=function(){var e=Object(d.a)(u.a.mark((function e(t){var c,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),_(""),w(""),P(""),console.log(i,j,p),e.prev=5,e.next=8,fetch("http://localhost:5000/login",{method:"POST",credentials:"include",body:JSON.stringify({name:i,email:j,password:p}),headers:{"Content-Type":"application/json"}});case 8:return c=e.sent,e.next=11,c.json();case 11:n=e.sent,console.log(n),n.errors&&(_(n.errors.email),w(n.errors.name),P(n.errors.password)),n.user&&s(n.user),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}();return t?Object(a.jsx)(O.a,{to:"/"}):Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("h2",{children:"Login"}),Object(a.jsxs)("form",{className:"col s12",onSubmit:T,children:[Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"input-field col s12",children:[Object(a.jsx)("input",{id:"email",type:"email",className:"validate",value:j,onChange:function(e){return m(e.target.value)}}),Object(a.jsx)("div",{className:"email error red-text",children:C}),Object(a.jsx)("label",{htmlFor:"email",children:"Email"})]})}),Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"input-field col s12",children:[Object(a.jsx)("input",{id:"password",type:"password",className:"validate",value:p,onChange:function(e){return v(e.target.value)}}),Object(a.jsx)("div",{className:"password error red-text",children:F}),Object(a.jsx)("label",{htmlFor:"password",children:"Password"})]})}),Object(a.jsx)("button",{className:"btn",children:"Login"})]})]})},M=function(){var e=Object(r.useContext)(h),t=e.user,s=e.setUser,c=Object(r.useState)(""),n=Object(b.a)(c,2),i=n[0],o=n[1],l=Object(r.useState)(""),j=Object(b.a)(l,2),m=j[0],x=j[1],f=Object(r.useState)(""),p=Object(b.a)(f,2),v=p[0],g=p[1],N=Object(r.useState)(""),w=Object(b.a)(N,2),S=w[0],y=w[1],C=Object(r.useState)(""),_=Object(b.a)(C,2),k=_[0],E=_[1],F=Object(r.useState)(""),P=Object(b.a)(F,2),T=P[0],M=P[1],L=function(){var e=Object(d.a)(u.a.mark((function e(t){var c,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),E(""),y(""),M(""),console.log(i,m,v),e.prev=5,e.next=8,fetch("http://localhost:5000/signup",{method:"POST",credentials:"include",body:JSON.stringify({name:i,email:m,password:v}),headers:{"Content-Type":"application/json"}});case 8:return c=e.sent,e.next=11,c.json();case 11:n=e.sent,console.log(n),n.errors&&(E(n.errors.email),y(n.errors.name),M(n.errors.password)),n.user&&s(n.user),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}();return t?Object(a.jsx)(O.a,{to:"/"}):Object(a.jsxs)("div",{className:"row",children:[Object(a.jsx)("h2",{children:"Sign up"}),Object(a.jsxs)("form",{className:"col s12",onSubmit:L,children:[Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"input-field col s12",children:[Object(a.jsx)("input",{id:"name",type:"text",className:"validate",value:i,onChange:function(e){return o(e.target.value)}}),Object(a.jsx)("div",{className:"name error red-text",children:S}),Object(a.jsx)("label",{htmlFor:"name",children:"Name"})]})}),Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"input-field col s12",children:[Object(a.jsx)("input",{id:"email",type:"email",className:"validate",value:m,onChange:function(e){return x(e.target.value)}}),Object(a.jsx)("div",{className:"email error red-text",children:k}),Object(a.jsx)("label",{htmlFor:"email",children:"Email"})]})}),Object(a.jsx)("div",{className:"row",children:Object(a.jsxs)("div",{className:"input-field col s12",children:[Object(a.jsx)("input",{id:"password",type:"password",className:"validate",value:v,onChange:function(e){return g(e.target.value)}}),Object(a.jsx)("div",{className:"password error red-text",children:T}),Object(a.jsx)("label",{htmlFor:"password",children:"Password"})]})}),Object(a.jsx)("button",{className:"btn",children:"Sign up"})]})]})};var L=function(){var e=Object(r.useState)(null),t=Object(b.a)(e,2),s=t[0],c=t[1];return Object(r.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(){var t,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5000/verifyuser",{credentials:"include",headers:{"Content-Type":"application/json"}});case 3:return t=e.sent,e.next=6,t.json();case 6:s=e.sent,c(s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.jsx)(m.a,{children:Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(h.Provider,{value:{user:s,setUser:c},children:[Object(a.jsx)(P,{}),Object(a.jsxs)(O.d,{children:[Object(a.jsx)(O.b,{exact:!0,path:"/",component:k}),Object(a.jsx)(O.b,{path:"/chat/:room_id/:room_name",component:y}),Object(a.jsx)(O.b,{path:"/signup",component:M}),Object(a.jsx)(O.b,{path:"/login",component:T})]})]})})})},U=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,129)).then((function(t){var s=t.getCLS,c=t.getFID,n=t.getFCP,a=t.getLCP,r=t.getTTFB;s(e),c(e),n(e),a(e),r(e)}))};l.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(L,{})}),document.getElementById("root")),U()},68:function(e,t,s){},70:function(e,t,s){},96:function(e,t){},99:function(e,t,s){}},[[127,1,2]]]);
//# sourceMappingURL=main.ea8a1519.chunk.js.map